apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: {{ .Values.global.namespace }}
  labels:
    app: todo-app
data:
  # Kafka Configuration
  KAFKA_BOOTSTRAP_SERVERS: {{ .Values.kafka.bootstrapServers | quote }}
  KAFKA_TOPIC_TASK_EVENTS: {{ .Values.kafka.topics.taskEvents | quote }}
  KAFKA_TOPIC_REMINDERS: {{ .Values.kafka.topics.reminders | quote }}
  KAFKA_TOPIC_TASK_UPDATES: {{ .Values.kafka.topics.taskUpdates | quote }}

  # Database Configuration
  DATABASE_HOST: {{ .Values.database.host | quote }}
  DATABASE_PORT: {{ .Values.database.port | quote }}
  DATABASE_NAME: {{ .Values.database.name | quote }}

  # Application Configuration
  ENVIRONMENT: {{ .Values.global.environment | quote }}
  LOG_LEVEL: {{ .Values.dapr.logLevel | quote }}

  # Dapr Configuration
  DAPR_HTTP_PORT: "3500"
  DAPR_GRPC_PORT: "50001"
  DAPR_METRICS_PORT: "9090"

  # Service Discovery
  CHAT_API_URL: "http://{{ .Values.chatApi.name }}:{{ .Values.chatApi.service.port }}"
  RECURRING_TASKS_URL: "http://{{ .Values.recurringTasks.name }}:{{ .Values.recurringTasks.service.port }}"
  NOTIFICATIONS_URL: "http://{{ .Values.notifications.name }}:{{ .Values.notifications.service.port }}"
  AUDIT_URL: "http://{{ .Values.audit.name }}:{{ .Values.audit.service.port }}"

  # Feature Flags
  ENABLE_METRICS: "true"
  ENABLE_TRACING: "true"
  ENABLE_HEALTH_CHECKS: "true"
